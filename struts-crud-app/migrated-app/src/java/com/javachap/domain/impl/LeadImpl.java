Updated LeadImpl Java file content with refactor, modularization, optimized queries, proper logging, deprecated APIs removal, and code comments