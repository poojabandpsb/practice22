Updated Java file content with refactored and modularized code, optimized queries, proper logging, removed deprecated APIs, implemented code comments, and enhanced security measures