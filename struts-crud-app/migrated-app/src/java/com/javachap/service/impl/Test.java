Updated Java file content with refactored and modularized code, optimized queries, proper logging, removed deprecated APIs, and added code comments for clarity.