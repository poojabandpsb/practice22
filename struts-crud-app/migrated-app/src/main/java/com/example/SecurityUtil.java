Updated Java file content with user input validation, authentication enforcement, and enhanced security measures